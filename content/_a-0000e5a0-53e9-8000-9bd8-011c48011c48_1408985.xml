<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <versionUuid>_a-0000e673-a4a7-8000-9bef-011c48011c48_2060597</versionUuid>
    <rule>
        <name>AS_FS_CHS_BL_extractCompanyInfoFromProfileResponse</name>
        <uuid>_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1408985</uuid>
        <description>Given the dictionary response of a company profile , retrieves the basic company information</description>
        <parentUuid>_a-0000e4b1-2fbc-8000-9bc6-011c48011c48_968428</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>a!localVariables(
  local!response: if(
    #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536"(ri!companyProfile.jsonResponse),
    null,
    #"SYSTEM_SYSRULES_fromJson_v1"(ri!companyProfile.jsonResponse)
  ),
  if(
    #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536"(local!response),
    null,
    'type!{urn:com:appian:types:AS:FS}AS_FS_CHS_CompanyDetails'(
      companyDetailsId: ri!companyDetails.companyDetailsId,
      customerId: ri!customerId,
      dateOfCreation: index(local!response, "date_of_creation", null),
      externalRegistrationNumber: index(
        local!response,
        "external_registration_number",
        null
      ),
      jurisdiction: index(local!response, "jurisdiction", null),
      class: index(local!response, "type", null),
      subclass: index(local!response, "subtype", null),
      companyStatus: index(local!response, "company_status", null),
      companyStatusDetail: index(
        local!response,
        "company_status_detail",
        null
      ),
      companyLink: a!localVariables(
        local!links: if(
          #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536"(local!response),
          null,
          index(local!response, "links", null)
        ),
        if(
          #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536"(local!links),
          null,
          #"_a-0000e2cd-bc96-8000-9ba2-011c48011c48_28158"(
            cdt: 'type!{urn:com:appian:types:AS:FS}AS_FS_CHS_CompanyLink'(
              customerId: ri!customerId,
              charges: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1446909"(index(local!links, "charges", null)),
              fillingHistory: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1446909"(
                index(local!links, "filing_history", null)
              ),
              insolvency: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1446909"(index(local!links, "insolvency", null)),
              officers: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1446909"(index(local!links, "officers", null)),
              overseas: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1446909"(index(local!links, "overseas", null)),
              personsWithSignificantControl: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1446909"(
                index(
                  local!links,
                  "persons_with_significant_control",
                  null
                )
              ),
              personsWithSignificantControlStatements: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1446909"(
                index(
                  local!links,
                  "persons_with_significant_control_statements",
                  null
                )
              ),
              registers: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1446909"(index(local!links, "registers", null)),
              selfLink: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1446909"(index(local!links, "self", null)),
              ukEstablishments: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1446909"(
                index(local!links, "uk_establishments", null)
              )
            ),
            modifiedBy: ri!user
          )
        )
      ),
      foreignCompanyDetails: a!localVariables(
        local!foreignCompanyDetails: if(
          #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536"(local!response),
          null,
          index(
            local!response,
            "foreign_company_details",
            null
          )
        ),
        if(
          #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536"(local!foreignCompanyDetails),
          null,
          #"_a-0000e2cd-bc96-8000-9ba2-011c48011c48_28158"(
            cdt: 'type!{urn:com:appian:types:AS:FS}AS_FS_CHS_ForeignCompanyDetails'(
              customerId: ri!customerId,
              foreignAccountType: #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76433"(
                cdt: local!foreignCompanyDetails,
                field: "accounting_requirement.foreign_account_type",
                indexDefault: null
              ),
              termsOfAccountPublication: #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76433"(
                cdt: local!foreignCompanyDetails,
                field: "accounting_requirement.terms_of_account_publication",
                indexDefault: null
              ),
              accountPeriodFromDay: #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76433"(
                cdt: local!foreignCompanyDetails,
                field: "accounts.account_period_from.day",
                indexDefault: null
              ),
              accountPeriodFromMonth: #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76433"(
                cdt: local!foreignCompanyDetails,
                field: "accounts.account_period_from.month",
                indexDefault: null
              ),
              accountPeriodToDay: #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76433"(
                cdt: local!foreignCompanyDetails,
                field: "accounts.account_period_to.day",
                indexDefault: null
              ),
              accountPeriodToMonth: #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76433"(
                cdt: local!foreignCompanyDetails,
                field: "accounts.account_period_to.month",
                indexDefault: null
              ),
              mustFileWithinMonths: #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76433"(
                cdt: local!foreignCompanyDetails,
                field: "accounts.must_file_within.months",
                indexDefault: null
              ),
              businessActivity: index(
                local!foreignCompanyDetails,
                "business_activity",
                null
              ),
              companyType: index(
                local!foreignCompanyDetails,
                "company_type",
                null
              ),
              governedBy: index(
                local!foreignCompanyDetails,
                "governed_by",
                null
              ),
              isCreditFinanceInstitution: index(
                local!foreignCompanyDetails,
                "is_a_credit_financial_institution",
                null
              ),
              originatingRegistryCountry: #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76433"(
                cdt: local!foreignCompanyDetails,
                field: "originating_registry.country",
                indexDefault: null
              ),
              originatingRegistryName: #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76433"(
                cdt: local!foreignCompanyDetails,
                field: "originating_registry.name",
                indexDefault: null
              ),
              registrationNumber: index(
                local!foreignCompanyDetails,
                "registration_number",
                null
              )
            ),
            modifiedBy: ri!user
          )
        )
      ),
      previousCompanyDetails: a!localVariables(
        local!previousCompanyDetails: if(
          #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536"(local!response),
          null,
          index(
            local!response,
            "previous_company_names",
            null
          )
        ),
        if(
          #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536"(local!previousCompanyDetails),
          null,
          a!flatten(
            #"SYSTEM_SYSRULES_forEach"(
              items: local!previousCompanyDetails,
              expression: #"_a-0000e2cd-bc96-8000-9ba2-011c48011c48_28158"(
                cdt: 'type!{urn:com:appian:types:AS:FS}AS_FS_CHS_PreviousCompanyDetails'(
                  customerId: ri!customerId,
                  ceasedOn: index(fv!item, "ceased_on", null),
                  effectiveFrom: index(fv!item, "effective_from", null),
                  previousCompanyName: index(fv!item, "name", null)
                ),
                modifiedBy: ri!user
              )
            )
          )
        )
      ),
      address: a!localVariables(
        local!address: if(
          #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536"(local!response),
          null,
          index(
            local!response,
            "registered_office_address",
            null
          )
        ),
        /*local!countryDetails: if(*/
        /*rule!AS_CO_UT_isBlank(local!address),*/
        /*null,*/
        /*rule!AS_FS_getCountryDetailsForRegisteredOffice(*/
        /*countryName: index(local!address, "country", null)*/
        /*)*/
        /*),*/
        if(
          #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536"(local!address),
          null,
          #"_a-0000e2cd-bc96-8000-9ba2-011c48011c48_28158"(
            cdt: 'type!{urn:com:appian:types:AS:FS}AS_FS_Address'(
              customerId: ri!customerId,
              addressType: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1428253",
              streetAddress: index(local!address, "address_line_1", null),
              addressLine2: index(local!address, "address_line_2", null),
              city: index(local!address, "locality", null),
              stateRegion: index(local!address, "region", null),
              countryCode: #"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1432909",
              /*index(*/
              /*local!countryDetails,*/
              /*"countryCode",*/
              /*null*/
              /*),*/
              postalCode: index(local!address, "postal_code", null)
            ),
            modifiedBy: ri!user
          )
        )
      ),
      createdBy: ri!companyDetails.createdBy,
      createdDatetime: ri!companyDetails.createdDatetime,
      modifiedBy: ri!companyDetails.modifiedBy,
      modifiedDatetime: ri!companyDetails.modifiedDatetime
    )
  )
)</definition>
        <namedTypedValue>
            <name>companyProfile</name>
            <type>
                <name>AS_EI_CHS_CompanyProfile</name>
                <namespace>urn:com:appian:types:AS:EI</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>customerId</name>
            <type>
                <name>int</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>user</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>companyDetails</name>
            <type>
                <name>AS_FS_CHS_CompanyDetails</name>
                <namespace>urn:com:appian:types:AS:FS</namespace>
            </type>
        </namedTypedValue>
        <preferredEditor>legacy</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
    </rule>
    <roleMap public="true">
        <role inherit="true" allowForAll="false" name="readers">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="authors">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="administrators">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
    <typedValue>
        <type>
            <name>RuleTestConfig?list</name>
            <namespace>http://www.appian.com/ae/types/2009</namespace>
        </type>
        <value>
            <el>
                <a:name>Valid</a:name>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">#"_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1409528"(
  returnType: #"_a-0000e415-3035-8000-9bb2-011c48011c48_290157",
  
)</a:value>
                    <a:nameRef>companyProfile</a:nameRef>
                    <a:id>1</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">6</a:value>
                    <a:nameRef>customerId</a:nameRef>
                    <a:id>2</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>user</a:nameRef>
                    <a:id>3</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
                    <a:nameRef>companyDetails</a:nameRef>
                    <a:id>4</a:id>
                </a:ruleInputTestConfigs>
                <a:assertions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
            </el>
        </value>
    </typedValue>
    <history>
        <historyInfo versionUuid="_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1410043"/>
        <historyInfo versionUuid="_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1435338"/>
        <historyInfo versionUuid="_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1447072"/>
        <historyInfo versionUuid="_a-0000e673-a4a7-8000-9bef-011c48011c48_2060597"/>
    </history>
</contentHaul>
