<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <versionUuid>_a-0000e62c-7375-8000-9bec-011c48011c48_1729177</versionUuid>
    <rule>
        <name>AS_FS_UT_clearHiddenProductFields</name>
        <uuid>_a-0000e539-6d59-8000-9bd0-011c48011c48_1135092</uuid>
        <description>Used to clear the value of any hidden product fields before it is saved.  This could occur if the product type was set, certain fields were populated, and then the product type was changed to one that does not include those fields.  Necessary because any hidden fields will not be checked for validation errors.</description>
        <parentUuid>_a-0000e4b1-2fbc-8000-9bc6-011c48011c48_968428</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>a!localVariables(
  local!allProductFields: #"_a-0000e50d-bf1d-8000-9bcd-011c48011c48_1021012"(isInternationalizedForAdminSetup: false),
  local!visibleFieldKeys: #"_a-0000e539-6d59-8000-9bd0-011c48011c48_1135183"(
    productTypeCode: ri!product.productTypeCode
  ),
  local!fieldPathsToRemoveIncludingCountries: a!flatten(
    #"_a-0000e40a-de32-8000-9ba8-011c48011c48_271202"(
      cdt: local!allProductFields,
      field: "fieldKey",
      value: local!visibleFieldKeys
    ).cdtField
  ),
  local!fieldPathsToRemove: if(
    and(
      #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_75782"(ri!product.countries),
      wherecontains(
        {
          #"_a-0000e50d-bf1d-8000-9bcd-011c48011c48_1021089",
          #"_a-0000e50d-bf1d-8000-9bcd-011c48011c48_1021083"
        },
        local!visibleFieldKeys
      ) &gt; 0
    ),
    #"_a-0000e2cd-bc96-8000-9ba2-011c48011c48_165064"(
      array: local!fieldPathsToRemoveIncludingCountries,
      values: "countries"
    ),
    local!fieldPathsToRemoveIncludingCountries
  ),
  local!productWithEntirelyHiddenNestedCdtsRemoved: #"_a-0000e40a-de32-8000-9ba8-011c48011c48_269170"(
    cdt: ri!product,
    fieldValuePairs: reject(
      fn!isnull(_),
      a!localVariables(
        local!visibleFieldPaths: #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_75800"(
          cdt: local!allProductFields,
          field: "fieldKey",
          value: local!visibleFieldKeys
        ).cdtField,
        #"SYSTEM_SYSRULES_forEach"(
          items: { "accounts", "thresholds", "fees", "term" },
          expression: if(
            contains(
              left(local!visibleFieldPaths, len(fv!item)),
              fv!item
            ),
            {},
            {
              field: fv!item,
              value: if(fv!item = "term", null, {})
            }
          )
        )
      )
    )
  ),
  #"_a-0000e40a-de32-8000-9ba8-011c48011c48_269170"(
    cdt: local!productWithEntirelyHiddenNestedCdtsRemoved,
    fieldValuePairs: reject(
      fn!isnull(_),
      #"SYSTEM_SYSRULES_forEach"(
        items: local!fieldPathsToRemove,
        expression: if(
          /*Blank check to prevent overwriting null nested CDTs */
          #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536"(
            #"_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76433"(
              cdt: local!productWithEntirelyHiddenNestedCdtsRemoved,
              field: fv!item
            )
          ),
          {},
          { field: fv!item, value: null }
        )
      )
    )
  )
)</definition>
        <namedTypedValue>
            <name>product</name>
            <type>
                <name>Map</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <preferredEditor>legacy</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
    </rule>
    <roleMap public="true">
        <role inherit="true" allowForAll="false" name="readers">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="authors">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="administrators">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
    <typedValue>
        <type>
            <name>RuleTestConfig?list</name>
            <namespace>http://www.appian.com/ae/types/2009</namespace>
        </type>
        <value>
            <el>
                <a:name>Sample test case</a:name>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">#"_a-0000e5d6-d648-8000-9bde-011c48011c48_1532334"(
  returnType: #"_a-0000e415-3035-8000-9bb2-011c48011c48_290157"
)</a:value>
                    <a:nameRef>product</a:nameRef>
                    <a:id>1</a:id>
                </a:ruleInputTestConfigs>
                <a:assertions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
            </el>
        </value>
    </typedValue>
    <history>
        <historyInfo versionUuid="_a-0000e539-6d59-8000-9bd0-011c48011c48_1139973"/>
        <historyInfo versionUuid="_a-0000e5a0-53e9-8000-9bd8-011c48011c48_1408074"/>
        <historyInfo versionUuid="_a-0000e62c-7375-8000-9bec-011c48011c48_1729177"/>
    </history>
</contentHaul>
